# Iptables esame 09/09/2022

### impostare la politica di default per la chain di input per non accettare pacchetti:
`iptables -P INPUT DROP`

### abilitare il traffico UDP in entrata sulla porta 5678:
`iptables -A INPUT -p udp --dport 5678 -j ACCEPT`

### accettare il traffico in ingresso relativo a connessioni iniziate sulla macchina:
`iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT`

### impostare la politica di default per la chain di output su accept:
`iptables -P OUTPUT ACCEPT`

### bloccare tutto il traffico idirizzato alla sottorete privata 192.168.5.0/24:
`iptables -A OUTPUT -d 192.168.5.0 --dport 24 -j DROP`

### scartare tutti i pacchetti relativi a connessioi TCP con porta di destinazioe 32768
`iptables -A OUTPUT -p tcp --dport 32768 -j DROP`

### utilizzando la tabella di NAT si modifichi la porta di destinazione dei pacchetti TCP 5000 a 5005:
`iptables -t nat -A PREROUTING -p tcp --dport REDIRECT --to-port 5005`