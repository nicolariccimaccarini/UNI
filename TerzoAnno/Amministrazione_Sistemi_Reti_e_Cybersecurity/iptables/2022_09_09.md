# Iptables esame 09/09/2022

### impostare la politica di default per la chain di input per non accettare pacchetti (INPUT):
`iptables -P INPUT DROP`

### abilitare il traffico UDP in entrata sulla porta 5678 (INPUT):
`iptables -A INPUT -p udp --dport 5678 -j ACCEPT`

### accettare il traffico in ingresso relativo alle connessioni iniziate dalla macchina (INPUT):
`iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT`

### impostare la politica di default per la chain di output su accept (OUTPUT):
`iptables -P OUTPUT ACCEPT`

### bloccare tutto il traffico indirizzato alla sottorete privata 192.168.5.0/24 (OUTPUT):
`iptables -A OUTPUT -d 192.168.5.0 --dport 24 -j DROP`

### scartare tutti i pacchetti relativi a connessioni TCP con porta di destinazione 32768 (OUTPUT):
`iptables -A OUTPUT -p tcp --dport 32768 -j DROP`

### utilizzando la tabella di nat si modifichi la porta di destinazione dei pacchetti TCP da 5000 a 5005:
`iptables -t nat -A PREROUTING -p tcp --dport 5000 -j REDIRECT --to-port 5005`