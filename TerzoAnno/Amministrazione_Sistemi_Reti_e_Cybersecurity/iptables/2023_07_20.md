# Iptables esame 10/07/2023

## Catena di INPUT

### impostare la politica di default per la chain per non consentire traffico in ingresso
`iptables -P INPUT DROP`

### accettare tutti i pacchetti provenienti dalla sottorete 10.12.1.0/24:
`iptables -A INPUT -s 10.12.1.0/24 -j ACCEPT`

### accettare tutti i pacchetti con porta sorgente UDP 7 e porta destinazioen UDP 7:
`iptables -A INPUT -p udp --sport 7 --dport 7 -j ACCEPT`

### accettare pacchetti relativi alle connessioni iniziate dalla workstation:
`iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT`

## Catena di OUTPUT

### impostare la politica di default su DROP:
`iptables -P OUTPUT DROP`

### consentire il traffico in uscita per il servizio di SSH:
`iptables -A OUTPUT -p tcp --dport 22 -j ACCEPT`

### consentire il traffico in uscita relativo a HTTP e HTTPS:
`iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT`
`iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT`

### consentire il traffico in uscita relativo a query DNS inviate dall'host
`iptables -A OUTPUT -p udp --dport 53 -j ACCEPT`
`iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT`

### consentire il traffico in uscita verso la sottorete 10.14.0.0/16:
`iptables -A OUTPUT -d 10.14.0.0/16 -j ACCEPT`

## Catena di FORWARD

### impostare la politica di default su DROP:
`iptables -P FORWARD DROP`

### consentire il traffico proveniente dall'interfaccia eth1 e destinato all'interfaccia eth0 con porta di destinazione TCP 25 con indirizzo di destinazione 10.16.22.15:
`iptables -A FORWARD -i eth1 -o eth0 -p tcp -d 10.16.22.15 --dport 25 -j ACCEPT`