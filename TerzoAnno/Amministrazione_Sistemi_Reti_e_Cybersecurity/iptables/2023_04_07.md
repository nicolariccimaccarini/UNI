# Iptables esame 04/07/2023

### impostare la politica di default per la chain per non consentire traffico in ingresso (INPUT):
`iptables -P INPUT DROP`

### accettare tutti i pacchetti dalla sottorete 192.168.22.0/24 (INPUT):
`iptables -A INPUT -s 192.168.22.0/24 -j ACCEPT`

### accettare tutti i pacchetti con destinazione porta TCP 45768 (INPUT):
`iptables -A INPUT -p tcp --dport 45768 -j ACCEPT`

### accettare tutti i pacchetti relativi alle connessioni iniziate dalla workstation (INPUT):
`iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT`

### impostare la politica di default su drop (OUTPUT):
`iptables -P OUTPUT DROP`

### consentire il traffico in uscita relativo a query DNS inviate dall'host (OUTPUT):
`iptables -A OUTPUT -p udp --dport 53 -j ACCEPT`
`iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT`

### consentire il traffico in uscita per i servizi HTTP e HTTPS (OUTPUT):
`iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT`
`iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT`

### Consentire il traffico in uscita per i servizi IMAP e SMTP (OUTPUT)
`iptables -A OUTPUT -p tcp --dport 143 -j ACCEPT`
`iptables -A OUTPUT -p tcp --dport 993 -j ACCEPT`
`iptables -A OUTPUT -p tcp --dport 25 -j ACCEPT`
`iptables -A OUTPUT -p tcp --dport 465 -j ACCEPT`

### consentire il traffico in uscita per il servizio di SSH (OUTPUT):
`iptables -A OUTPUT -p tcp --dport 22 -j ACCEPT`

### impostare la politica di default su drop (FORWARD):
`iptables -P FORWARD DROP`

### consentire il traffico proveniente dall'interfaccia wlan0 e destinato all'interfaccia eth0 con porta di destinazione TCP 22 (FORWARD):
`iptables -A FORWARD -i wlan0 -o eth0 -p tcp --dport 22 -j ACCEPT`